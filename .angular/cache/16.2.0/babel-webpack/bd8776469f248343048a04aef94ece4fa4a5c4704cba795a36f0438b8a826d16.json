{"ast":null,"code":"import { HttpClient } from \"@angular/common/http\";\nimport { Movie } from \"../models/movie\";\nimport { environment as ENV } from \"../../environments/environment\";\nimport { Subject, BehaviorSubject } from \"rxjs\";\nimport { tap } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let MoviesService = /*#__PURE__*/(() => {\n  var _class;\n  class MoviesService {\n    constructor(httpClient) {\n      this.httpClient = httpClient;\n      this.movies = new BehaviorSubject(Array());\n      this.wsUrl = ENV.apiUrl + \"/movies\";\n      this.search = new Subject();\n      this.genreSelectedS = new BehaviorSubject(Array());\n      this.genreSelectedA = new BehaviorSubject(Array());\n      this.realsSelected = new BehaviorSubject(Array());\n      this.actorsSelected = new BehaviorSubject(Array());\n    }\n    addGenreSelectedS(genre) {\n      let arrayGenresS = this.genreSelectedS.value;\n      arrayGenresS.push(genre);\n      this.genreSelectedS.next(arrayGenresS);\n      console.log(arrayGenresS);\n    }\n    removeGenreSelectedS(genre) {\n      this.genreSelectedS.next(this.genreSelectedS.value.filter(g => g !== genre));\n    }\n    get getFinalPage() {\n      return this._finalPage;\n    }\n    getMoviesPage(page) {\n      return this.httpClient.get(`${this.wsUrl}/${page}`).pipe(tap(page => {\n        this.movies.next(page.content);\n        this._finalPage = page.totalPages - 1;\n      })).toPromise();\n    }\n    getBestAlloMovie() {\n      return this.httpClient.get(`${this.wsUrl}/bestAlloMovie`).toPromise();\n    }\n    getMoviesPageWithExclusions(page, genres, casting, realisateurs) {\n      return this.httpClient.post(`${this.wsUrl}/exclusions/${page}`, {\n        genres: genres,\n        casting: casting,\n        realisateurs: realisateurs\n      }).pipe(tap(page => {\n        this.movies.next(page.content);\n        this._finalPage = page.totalPages - 1;\n      })).toPromise();\n    }\n    getIndexMovie(id) {\n      return this.movies.value.findIndex(movie => movie.id === id);\n    }\n    createMovie(movie) {\n      let movies = this.movies.value;\n      this.httpClient.post(this.wsUrl, movie).subscribe(movieFromJee => {\n        movies.push(new Movie(movieFromJee.titre, movieFromJee.synopsis, movieFromJee.genres, movieFromJee.casting, movieFromJee.realisateur, movieFromJee.covPortrait, movieFromJee.covPaysage, movie.time, movieFromJee.year, movieFromJee.pegi, movieFromJee.avertissement, movieFromJee.id));\n        this.movies.next(movies);\n      });\n    }\n    updateMovie(movie) {\n      let movies = this.movies.value;\n      this.httpClient.put(this.wsUrl + `/${movie.id}`, movie).subscribe(movieFromJee => {\n        const index = this.getIndexMovie(movie.id);\n        if (index >= 0) {\n          movies.splice(index, 1, new Movie(movieFromJee.titre, movieFromJee.synopsis, movieFromJee.genres, movieFromJee.casting, movieFromJee.realisateur, movieFromJee.covPortrait, movieFromJee.covPaysage, movie.time, movieFromJee.year, movieFromJee.pegi, movieFromJee.avertissement, movieFromJee.id, movieFromJee.grade, movieFromJee.alloGrade, movieFromJee.imdbGrade));\n          this.movies.next(movies);\n        }\n      });\n    }\n    getGenreSelectedS() {\n      return this.genreSelectedS;\n    }\n    getGenreSelectedA() {\n      return this.genreSelectedA;\n    }\n    getRealsSelected() {\n      return this.realsSelected;\n    }\n    getActorsSelected() {\n      return this.actorsSelected;\n    }\n    getRealisateurs() {\n      this.realisateurs = new Array();\n      this.httpClient.get(this.wsUrl + `/realisateurs`).subscribe(list => this.realisateurs.push(...list));\n      return this.realisateurs;\n    }\n    getActors() {\n      this.actors = new Array();\n      this.httpClient.get(this.wsUrl + `/acteurs`).subscribe(list => this.actors.push(...list));\n      return this.actors;\n    }\n    // public getMoviesByGenre(genre: string): Observable<Array<Movie>> {\n    //   return this.httpClient.get<Array<Movie>>(this.wsUrl + `/byGenre/${genre}`);\n    // }\n    getSelectedGenresS() {\n      return this.genreSelectedS.value;\n    }\n    getSelectedGenresA() {\n      return this.genreSelectedA.value;\n    }\n    getSelectedReals() {\n      return this.realsSelected.value;\n    }\n    getSelectedActors() {\n      return this.actorsSelected.value;\n    }\n    setSearch(search) {\n      this.search.next(search);\n    }\n    getSearch() {\n      return this.search.asObservable();\n    }\n    getUpperForFirstLetter(type) {\n      return type[0].toUpperCase() + type.substring(1);\n    }\n  }\n  _class = MoviesService;\n  _class.ɵfac = function MoviesService_Factory(t) {\n    return new (t || _class)(i0.ɵɵinject(i1.HttpClient));\n  };\n  _class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: _class,\n    factory: _class.ɵfac,\n    providedIn: \"root\"\n  });\n  return MoviesService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}